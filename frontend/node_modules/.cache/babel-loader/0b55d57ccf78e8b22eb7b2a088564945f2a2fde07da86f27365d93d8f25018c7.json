{"ast":null,"code":"var _jsxFileName = \"F:\\\\mentor\\\\ktx - Copy\\\\frontend\\\\src\\\\pages\\\\student\\\\AvailableRooms.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Container, Paper, Typography, Grid, Card, CardContent, CardActions, Button, Alert, CircularProgress, Box, Dialog, DialogTitle, DialogContent, DialogContentText, DialogActions } from '@mui/material';\nimport { roomService } from '../../services/room.service';\nimport { roomAssignmentService } from '../../services/roomAssignment.service';\nimport { authService } from '../../services/auth.service';\nimport { studentService } from '../../services/student.service';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AvailableRooms = () => {\n  _s();\n  const navigate = useNavigate();\n  const [rooms, setRooms] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [hasRoomAssignment, setHasRoomAssignment] = useState(false);\n  const [autoRegisterDialogOpen, setAutoRegisterDialogOpen] = useState(false);\n  const [autoRegistering, setAutoRegistering] = useState(false);\n  const [success, setSuccess] = useState('');\n  const currentUser = authService.getCurrentUser();\n  const [studentId, setStudentId] = useState(null);\n  const [studentYear, setStudentYear] = useState(null);\n  useEffect(() => {\n    const initializeData = async () => {\n      try {\n        var _studentResponse$data;\n        if (!(currentUser !== null && currentUser !== void 0 && currentUser.user.id)) {\n          console.log('No current user found');\n          return;\n        }\n        console.log('Initializing data for user:', currentUser.user.id);\n\n        // Lấy thông tin sinh viên trước\n        const studentResponse = await studentService.getStudentByUserId(currentUser.user.id);\n        console.log('Student data:', studentResponse);\n        if (!(studentResponse !== null && studentResponse !== void 0 && (_studentResponse$data = studentResponse.data) !== null && _studentResponse$data !== void 0 && _studentResponse$data.data)) {\n          console.log('No student data found in response:', studentResponse);\n          setError('Không tìm thấy thông tin sinh viên');\n          return;\n        }\n        const studentData = studentResponse.data.data;\n        console.log('Student data after extraction:', studentData);\n        if (typeof studentData.year !== 'number') {\n          console.log('Invalid year value:', studentData.year);\n          setError('Thông tin năm học không hợp lệ');\n          return;\n        }\n        console.log('Setting student data:', {\n          id: studentData.id,\n          year: studentData.year\n        });\n        setStudentId(studentData.id);\n        setStudentYear(studentData.year);\n\n        // Đợi state được cập nhật\n        await new Promise(resolve => setTimeout(resolve, 100));\n\n        // Sau khi có thông tin sinh viên, mới lấy danh sách phòng\n        await fetchAvailableRooms();\n        await checkRoomAssignment();\n      } catch (err) {\n        console.error('Error initializing data:', err);\n        setError('Không thể tải thông tin sinh viên');\n      }\n    };\n\n    // Chỉ gọi initializeData khi component mount\n    initializeData();\n  }, []); // Bỏ currentUser khỏi dependencies\n\n  // Thêm useEffect mới để xử lý khi currentUser thay đổi\n  useEffect(() => {\n    if (currentUser !== null && currentUser !== void 0 && currentUser.user.id) {\n      // Reset các state\n      setStudentId(null);\n      setStudentYear(null);\n      setRooms([]);\n      setError('');\n\n      // Gọi lại initializeData\n      const initializeData = async () => {\n        try {\n          var _studentResponse$data2;\n          console.log('Reinitializing data for user:', currentUser.user.id);\n          const studentResponse = await studentService.getStudentByUserId(currentUser.user.id);\n          console.log('Student data on reinitialize:', studentResponse);\n          if (!(studentResponse !== null && studentResponse !== void 0 && (_studentResponse$data2 = studentResponse.data) !== null && _studentResponse$data2 !== void 0 && _studentResponse$data2.data)) {\n            console.log('No student data found in response:', studentResponse);\n            setError('Không tìm thấy thông tin sinh viên');\n            return;\n          }\n          const studentData = studentResponse.data.data;\n          console.log('Student data after extraction:', studentData);\n          if (typeof studentData.year !== 'number') {\n            console.log('Invalid year value:', studentData.year);\n            setError('Thông tin năm học không hợp lệ');\n            return;\n          }\n          setStudentId(studentData.id);\n          setStudentYear(studentData.year);\n          await new Promise(resolve => setTimeout(resolve, 100));\n          await fetchAvailableRooms();\n          await checkRoomAssignment();\n        } catch (err) {\n          console.error('Error reinitializing data:', err);\n          setError('Không thể tải thông tin sinh viên');\n        }\n      };\n      initializeData();\n    }\n  }, [currentUser === null || currentUser === void 0 ? void 0 : currentUser.user.id]); // Chỉ phụ thuộc vào user.id\n\n  // Thêm useEffect để reset state khi component unmount\n  useEffect(() => {\n    return () => {\n      setStudentId(null);\n      setStudentYear(null);\n      setRooms([]);\n      setError('');\n      setHasRoomAssignment(false);\n      setAutoRegisterDialogOpen(false);\n      setAutoRegistering(false);\n      setSuccess('');\n    };\n  }, []);\n\n  // Thêm useEffect để xử lý khi currentUser thay đổi\n  useEffect(() => {\n    const handleUserChange = async () => {\n      // Reset tất cả state\n      setStudentId(null);\n      setStudentYear(null);\n      setRooms([]);\n      setError('');\n      setHasRoomAssignment(false);\n      setAutoRegisterDialogOpen(false);\n      setAutoRegistering(false);\n      setSuccess('');\n      if (!(currentUser !== null && currentUser !== void 0 && currentUser.user.id)) {\n        console.log('No current user, skipping initialization');\n        return;\n      }\n      try {\n        console.log('Initializing data for new user:', currentUser.user.id);\n\n        // Lấy thông tin sinh viên\n        const studentResponse = await studentService.getStudentByUserId(currentUser.user.id);\n        console.log('Student data for new user:', studentResponse.data);\n        if (!studentResponse.data || typeof studentResponse.data.year !== 'number') {\n          console.log('Invalid student data:', studentResponse);\n          setError('Không tìm thấy thông tin năm học của sinh viên');\n          return;\n        }\n\n        // Set state với dữ liệu mới\n        setStudentId(studentResponse.data.id);\n        setStudentYear(studentResponse.data.year);\n\n        // Đợi state cập nhật\n        await new Promise(resolve => setTimeout(resolve, 100));\n\n        // Lấy danh sách phòng và kiểm tra đăng ký\n        await fetchAvailableRooms();\n        await checkRoomAssignment();\n      } catch (err) {\n        console.error('Error initializing data for new user:', err);\n        setError('Không thể tải thông tin sinh viên');\n      }\n    };\n    handleUserChange();\n  }, [currentUser === null || currentUser === void 0 ? void 0 : currentUser.user.id]);\n\n  // Bỏ useEffect cũ vì đã được thay thế bằng useEffect mới ở trên\n  useEffect(() => {\n    // Chỉ gọi initializeData khi component mount và không có currentUser\n    if (!(currentUser !== null && currentUser !== void 0 && currentUser.user.id)) {\n      console.log('Component mounted without user, skipping initialization');\n    }\n  }, []);\n  const checkRoomAssignment = async () => {\n    try {\n      if (!(currentUser !== null && currentUser !== void 0 && currentUser.user.id)) return;\n\n      // Lấy thông tin sinh viên\n      const studentResponse = await studentService.getStudentByUserId(currentUser.user.id);\n      const studentId = studentResponse.data.id;\n\n      // Lấy danh sách yêu cầu đăng ký phòng\n      const assignmentsResponse = await roomAssignmentService.getRoomAssignments();\n      const assignments = assignmentsResponse.data || [];\n\n      // Kiểm tra xem sinh viên có yêu cầu đăng ký đang chờ hoặc đã có phòng không\n      const hasAssignment = assignments.some(assignment => assignment.studentId === studentId && (assignment.status === 'pending' || assignment.status === 'active'));\n      setHasRoomAssignment(hasAssignment);\n    } catch (err) {\n      console.error('Error checking room assignment:', err);\n    }\n  };\n  const fetchAvailableRooms = async () => {\n    try {\n      setLoading(true);\n      setError('');\n      console.log('Fetching available rooms for student year:', studentYear);\n      if (studentYear === null) {\n        console.log('Student year is null, skipping room fetch');\n        return;\n      }\n      const response = await roomService.getAllRooms();\n      console.log('Raw API response:', response);\n\n      // Kiểm tra cấu trúc dữ liệu trả về\n      let allRooms = [];\n      if (response && response.data) {\n        // Nếu API trả về dữ liệu trong thuộc tính data\n        allRooms = Array.isArray(response.data) ? response.data : [];\n        console.log('Extracted rooms from response.data:', allRooms);\n      } else if (Array.isArray(response)) {\n        // Nếu API trả về trực tiếp một mảng\n        allRooms = response;\n        console.log('Using response directly as rooms array:', allRooms);\n      } else {\n        console.error('Unexpected API response format:', response);\n        setError('Định dạng dữ liệu không hợp lệ');\n        setRooms([]);\n        return;\n      }\n      console.log('All Rooms Before Filter:', allRooms);\n\n      // Lọc các phòng còn trống và phù hợp với năm học của sinh viên\n      const availableRooms = allRooms.filter(room => {\n        // Log chi tiết từng phòng trước khi lọc\n        console.log('Checking room:', {\n          roomId: room.id,\n          roomNumber: room.roomNumber,\n          floor: room.floor,\n          status: room.status,\n          currentOccupancy: room.currentOccupancy,\n          capacity: room.capacity,\n          studentYear: studentYear\n        });\n        const isAvailable = room.status === 'available' || room.status === 'Đã có Người ở';\n        const isMatchingYear = Number(room.floor) === Number(studentYear);\n        const hasSpace = room.currentOccupancy < room.capacity;\n        console.log('Room conditions:', {\n          roomNumber: room.roomNumber,\n          isAvailable,\n          isMatchingYear,\n          hasSpace,\n          willBeIncluded: isAvailable && isMatchingYear && hasSpace\n        });\n        return isAvailable && isMatchingYear && hasSpace;\n      });\n      console.log('Available Rooms After Filter:', availableRooms);\n      setRooms(availableRooms);\n      if (availableRooms.length === 0) {\n        setError(`Hiện không có phòng nào khả dụng cho sinh viên năm ${studentYear}`);\n      }\n    } catch (error) {\n      console.error('Error fetching rooms:', error);\n      setError(error.message || 'Có lỗi xảy ra khi tải danh sách phòng');\n      setRooms([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleRegisterRoom = roomId => {\n    navigate(`/student/room-registration/${roomId}`);\n  };\n  const handleAutoRegister = async () => {\n    if (!studentId) {\n      setError('Không tìm thấy thông tin sinh viên');\n      return;\n    }\n    setAutoRegistering(true);\n    setError('');\n    setSuccess('');\n    try {\n      // Tìm phòng còn trống đầu tiên phù hợp với năm học của sinh viên\n      const availableRoom = rooms.find(room => {\n        const isAvailable = room.status === 'available' || room.status === 'Đã có Người ở' && room.currentOccupancy < room.capacity;\n        const isMatchingYear = room.floor === studentYear;\n        const hasSpace = room.currentOccupancy < room.capacity;\n        return isAvailable && isMatchingYear && hasSpace;\n      });\n      if (!availableRoom) {\n        setError(studentYear !== null ? `Hiện không có phòng nào khả dụng cho sinh viên năm ${studentYear}` : 'Hiện không có phòng nào khả dụng');\n        return;\n      }\n\n      // Đăng ký phòng tự động\n      await roomAssignmentService.assignRoom({\n        roomId: availableRoom.id,\n        studentId: studentId,\n        startDate: new Date().toISOString().split('T')[0],\n        endDate: '',\n        isAdmin: true // Đánh dấu là đăng ký tự động, không cần xét duyệt\n      });\n      setSuccess(`Đã đăng ký thành công vào phòng ${availableRoom.building} - ${availableRoom.roomNumber}`);\n      setAutoRegisterDialogOpen(false);\n      navigate('/student/home');\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Không thể đăng ký phòng tự động');\n    } finally {\n      setAutoRegistering(false);\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      minHeight: \"60vh\",\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    children: [/*#__PURE__*/_jsxDEV(Paper, {\n      sx: {\n        p: 4,\n        mt: 4\n      },\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n        mb: 3,\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h4\",\n          gutterBottom: true,\n          children: [\"Danh s\\xE1ch ph\\xF2ng c\\xF3 s\\u1EB5n\", studentYear !== null ? ` cho sinh viên năm ${studentYear}` : '']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 374,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          onClick: () => setAutoRegisterDialogOpen(true),\n          disabled: hasRoomAssignment || rooms.length === 0,\n          children: \"\\u0110\\u0103ng k\\xFD t\\u1EF1 \\u0111\\u1ED9ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 373,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(Alert, {\n        severity: \"error\",\n        sx: {\n          mb: 2\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 11\n      }, this), success && /*#__PURE__*/_jsxDEV(Alert, {\n        severity: \"success\",\n        sx: {\n          mb: 2\n        },\n        children: success\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 11\n      }, this), hasRoomAssignment && /*#__PURE__*/_jsxDEV(Alert, {\n        severity: \"info\",\n        sx: {\n          mb: 2\n        },\n        children: \"B\\u1EA1n \\u0111\\xE3 c\\xF3 y\\xEAu c\\u1EA7u \\u0111\\u0103ng k\\xFD ph\\xF2ng \\u0111ang ch\\u1EDD ph\\xEA duy\\u1EC7t ho\\u1EB7c \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c g\\xE1n ph\\xF2ng.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        container: true,\n        spacing: 3,\n        children: rooms.map(room => /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          xs: 12,\n          sm: 6,\n          md: 4,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            children: [/*#__PURE__*/_jsxDEV(CardContent, {\n              children: [/*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"h6\",\n                gutterBottom: true,\n                children: [\"Ph\\xF2ng \", room.roomNumber]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 410,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                color: \"textSecondary\",\n                gutterBottom: true,\n                children: [\"T\\xF2a \", room.building, \" - T\\u1EA7ng \", room.floor]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 413,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body2\",\n                children: [\"Lo\\u1EA1i ph\\xF2ng: \", room.type]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body2\",\n                children: [\"Gi\\xE1 ph\\xF2ng: \", room.price.toLocaleString('vi-VN'), \" VN\\u0110/th\\xE1ng\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 419,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body2\",\n                children: [\"S\\u1EE9c ch\\u1EE9a: \", room.currentOccupancy, \"/\", room.capacity]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 422,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"body2\",\n                color: \"primary\",\n                children: [\"Tr\\u1EA1ng th\\xE1i: \", room.status]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 425,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 409,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(CardActions, {\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                size: \"small\",\n                color: \"primary\",\n                onClick: () => handleRegisterRoom(room.id),\n                disabled: hasRoomAssignment,\n                children: \"\\u0110\\u0103ng k\\xFD\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 430,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 429,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 15\n          }, this)\n        }, room.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: autoRegisterDialogOpen,\n      onClose: () => !autoRegistering && setAutoRegisterDialogOpen(false),\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"X\\xE1c nh\\u1EADn \\u0111\\u0103ng k\\xFD t\\u1EF1 \\u0111\\u1ED9ng\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: \"H\\u1EC7 th\\u1ED1ng s\\u1EBD t\\u1EF1 \\u0111\\u1ED9ng \\u0111\\u0103ng k\\xFD b\\u1EA1n v\\xE0o ph\\xF2ng c\\xF2n tr\\u1ED1ng \\u0111\\u1EA7u ti\\xEAn ph\\xF9 h\\u1EE3p v\\u1EDBi n\\u0103m h\\u1ECDc c\\u1EE7a b\\u1EA1n. B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n ti\\u1EBFp t\\u1EE5c?\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 451,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => setAutoRegisterDialogOpen(false),\n          disabled: autoRegistering,\n          children: \"H\\u1EE7y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleAutoRegister,\n          color: \"primary\",\n          disabled: autoRegistering,\n          autoFocus: true,\n          children: autoRegistering ? /*#__PURE__*/_jsxDEV(CircularProgress, {\n            size: 24\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 32\n          }, this) : 'Xác nhận'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 456,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 371,\n    columnNumber: 5\n  }, this);\n};\n_s(AvailableRooms, \"aEUDBb3NTnbH7jj7fvsFL6DcvXw=\", false, function () {\n  return [useNavigate];\n});\n_c = AvailableRooms;\nvar _c;\n$RefreshReg$(_c, \"AvailableRooms\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","Container","Paper","Typography","Grid","Card","CardContent","CardActions","Button","Alert","CircularProgress","Box","Dialog","DialogTitle","DialogContent","DialogContentText","DialogActions","roomService","roomAssignmentService","authService","studentService","jsxDEV","_jsxDEV","AvailableRooms","_s","navigate","rooms","setRooms","loading","setLoading","error","setError","hasRoomAssignment","setHasRoomAssignment","autoRegisterDialogOpen","setAutoRegisterDialogOpen","autoRegistering","setAutoRegistering","success","setSuccess","currentUser","getCurrentUser","studentId","setStudentId","studentYear","setStudentYear","initializeData","_studentResponse$data","user","id","console","log","studentResponse","getStudentByUserId","data","studentData","year","Promise","resolve","setTimeout","fetchAvailableRooms","checkRoomAssignment","err","_studentResponse$data2","handleUserChange","assignmentsResponse","getRoomAssignments","assignments","hasAssignment","some","assignment","status","response","getAllRooms","allRooms","Array","isArray","availableRooms","filter","room","roomId","roomNumber","floor","currentOccupancy","capacity","isAvailable","isMatchingYear","Number","hasSpace","willBeIncluded","length","message","handleRegisterRoom","handleAutoRegister","availableRoom","find","assignRoom","startDate","Date","toISOString","split","endDate","isAdmin","building","_err$response","_err$response$data","display","justifyContent","alignItems","minHeight","children","fileName","_jsxFileName","lineNumber","columnNumber","maxWidth","sx","p","mt","mb","variant","gutterBottom","color","onClick","disabled","severity","container","spacing","map","item","xs","sm","md","type","price","toLocaleString","size","open","onClose","autoFocus","_c","$RefreshReg$"],"sources":["F:/mentor/ktx - Copy/frontend/src/pages/student/AvailableRooms.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n  Container,\r\n  Paper,\r\n  Typography,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  CardActions,\r\n  Button,\r\n  Alert,\r\n  CircularProgress,\r\n  Box,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogContentText,\r\n  DialogActions\r\n} from '@mui/material';\r\nimport { roomService } from '../../services/room.service';\r\nimport { roomAssignmentService } from '../../services/roomAssignment.service';\r\nimport { Room } from '../../types/room';\r\nimport { authService } from '../../services/auth.service';\r\nimport { studentService } from '../../services/student.service';\r\n\r\nexport const AvailableRooms: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const [rooms, setRooms] = useState<Room[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [hasRoomAssignment, setHasRoomAssignment] = useState(false);\r\n  const [autoRegisterDialogOpen, setAutoRegisterDialogOpen] = useState(false);\r\n  const [autoRegistering, setAutoRegistering] = useState(false);\r\n  const [success, setSuccess] = useState('');\r\n  const currentUser = authService.getCurrentUser();\r\n  const [studentId, setStudentId] = useState<number | null>(null);\r\n  const [studentYear, setStudentYear] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    const initializeData = async () => {\r\n      try {\r\n        if (!currentUser?.user.id) {\r\n          console.log('No current user found');\r\n          return;\r\n        }\r\n        \r\n        console.log('Initializing data for user:', currentUser.user.id);\r\n        \r\n        // Lấy thông tin sinh viên trước\r\n        const studentResponse = await studentService.getStudentByUserId(currentUser.user.id);\r\n        console.log('Student data:', studentResponse);\r\n        \r\n        if (!studentResponse?.data?.data) {\r\n          console.log('No student data found in response:', studentResponse);\r\n          setError('Không tìm thấy thông tin sinh viên');\r\n          return;\r\n        }\r\n\r\n        const studentData = studentResponse.data.data;\r\n        console.log('Student data after extraction:', studentData);\r\n\r\n        if (typeof studentData.year !== 'number') {\r\n          console.log('Invalid year value:', studentData.year);\r\n          setError('Thông tin năm học không hợp lệ');\r\n          return;\r\n        }\r\n\r\n        console.log('Setting student data:', {\r\n          id: studentData.id,\r\n          year: studentData.year\r\n        });\r\n\r\n        setStudentId(studentData.id);\r\n        setStudentYear(studentData.year);\r\n        \r\n        // Đợi state được cập nhật\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n        \r\n        // Sau khi có thông tin sinh viên, mới lấy danh sách phòng\r\n        await fetchAvailableRooms();\r\n        await checkRoomAssignment();\r\n      } catch (err: any) {\r\n        console.error('Error initializing data:', err);\r\n        setError('Không thể tải thông tin sinh viên');\r\n      }\r\n    };\r\n\r\n    // Chỉ gọi initializeData khi component mount\r\n    initializeData();\r\n  }, []); // Bỏ currentUser khỏi dependencies\r\n\r\n  // Thêm useEffect mới để xử lý khi currentUser thay đổi\r\n  useEffect(() => {\r\n    if (currentUser?.user.id) {\r\n      // Reset các state\r\n      setStudentId(null);\r\n      setStudentYear(null);\r\n      setRooms([]);\r\n      setError('');\r\n      \r\n      // Gọi lại initializeData\r\n      const initializeData = async () => {\r\n        try {\r\n          console.log('Reinitializing data for user:', currentUser.user.id);\r\n          \r\n          const studentResponse = await studentService.getStudentByUserId(currentUser.user.id);\r\n          console.log('Student data on reinitialize:', studentResponse);\r\n          \r\n          if (!studentResponse?.data?.data) {\r\n            console.log('No student data found in response:', studentResponse);\r\n            setError('Không tìm thấy thông tin sinh viên');\r\n            return;\r\n          }\r\n\r\n          const studentData = studentResponse.data.data;\r\n          console.log('Student data after extraction:', studentData);\r\n\r\n          if (typeof studentData.year !== 'number') {\r\n            console.log('Invalid year value:', studentData.year);\r\n            setError('Thông tin năm học không hợp lệ');\r\n            return;\r\n          }\r\n\r\n          setStudentId(studentData.id);\r\n          setStudentYear(studentData.year);\r\n          \r\n          await new Promise(resolve => setTimeout(resolve, 100));\r\n          await fetchAvailableRooms();\r\n          await checkRoomAssignment();\r\n        } catch (err: any) {\r\n          console.error('Error reinitializing data:', err);\r\n          setError('Không thể tải thông tin sinh viên');\r\n        }\r\n      };\r\n\r\n      initializeData();\r\n    }\r\n  }, [currentUser?.user.id]); // Chỉ phụ thuộc vào user.id\r\n\r\n  // Thêm useEffect để reset state khi component unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      setStudentId(null);\r\n      setStudentYear(null);\r\n      setRooms([]);\r\n      setError('');\r\n      setHasRoomAssignment(false);\r\n      setAutoRegisterDialogOpen(false);\r\n      setAutoRegistering(false);\r\n      setSuccess('');\r\n    };\r\n  }, []);\r\n\r\n  // Thêm useEffect để xử lý khi currentUser thay đổi\r\n  useEffect(() => {\r\n    const handleUserChange = async () => {\r\n      // Reset tất cả state\r\n      setStudentId(null);\r\n      setStudentYear(null);\r\n      setRooms([]);\r\n      setError('');\r\n      setHasRoomAssignment(false);\r\n      setAutoRegisterDialogOpen(false);\r\n      setAutoRegistering(false);\r\n      setSuccess('');\r\n\r\n      if (!currentUser?.user.id) {\r\n        console.log('No current user, skipping initialization');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        console.log('Initializing data for new user:', currentUser.user.id);\r\n        \r\n        // Lấy thông tin sinh viên\r\n        const studentResponse = await studentService.getStudentByUserId(currentUser.user.id);\r\n        console.log('Student data for new user:', studentResponse.data);\r\n        \r\n        if (!studentResponse.data || typeof studentResponse.data.year !== 'number') {\r\n          console.log('Invalid student data:', studentResponse);\r\n          setError('Không tìm thấy thông tin năm học của sinh viên');\r\n          return;\r\n        }\r\n\r\n        // Set state với dữ liệu mới\r\n        setStudentId(studentResponse.data.id);\r\n        setStudentYear(studentResponse.data.year);\r\n        \r\n        // Đợi state cập nhật\r\n        await new Promise(resolve => setTimeout(resolve, 100));\r\n        \r\n        // Lấy danh sách phòng và kiểm tra đăng ký\r\n        await fetchAvailableRooms();\r\n        await checkRoomAssignment();\r\n      } catch (err: any) {\r\n        console.error('Error initializing data for new user:', err);\r\n        setError('Không thể tải thông tin sinh viên');\r\n      }\r\n    };\r\n\r\n    handleUserChange();\r\n  }, [currentUser?.user.id]);\r\n\r\n  // Bỏ useEffect cũ vì đã được thay thế bằng useEffect mới ở trên\r\n  useEffect(() => {\r\n    // Chỉ gọi initializeData khi component mount và không có currentUser\r\n    if (!currentUser?.user.id) {\r\n      console.log('Component mounted without user, skipping initialization');\r\n    }\r\n  }, []);\r\n\r\n  const checkRoomAssignment = async () => {\r\n    try {\r\n      if (!currentUser?.user.id) return;\r\n      \r\n      // Lấy thông tin sinh viên\r\n      const studentResponse = await studentService.getStudentByUserId(currentUser.user.id);\r\n      const studentId = studentResponse.data.id;\r\n\r\n      // Lấy danh sách yêu cầu đăng ký phòng\r\n      const assignmentsResponse = await roomAssignmentService.getRoomAssignments();\r\n      const assignments = assignmentsResponse.data || [];\r\n\r\n      // Kiểm tra xem sinh viên có yêu cầu đăng ký đang chờ hoặc đã có phòng không\r\n      const hasAssignment = assignments.some((assignment: any) => \r\n        assignment.studentId === studentId && \r\n        (assignment.status === 'pending' || assignment.status === 'active')\r\n      );\r\n\r\n      setHasRoomAssignment(hasAssignment);\r\n    } catch (err: any) {\r\n      console.error('Error checking room assignment:', err);\r\n    }\r\n  };\r\n\r\n  const fetchAvailableRooms = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError('');\r\n      console.log('Fetching available rooms for student year:', studentYear);\r\n      \r\n      if (studentYear === null) {\r\n        console.log('Student year is null, skipping room fetch');\r\n        return;\r\n      }\r\n      \r\n      const response = await roomService.getAllRooms();\r\n      console.log('Raw API response:', response);\r\n      \r\n      // Kiểm tra cấu trúc dữ liệu trả về\r\n      let allRooms: Room[] = [];\r\n      \r\n      if (response && response.data) {\r\n        // Nếu API trả về dữ liệu trong thuộc tính data\r\n        allRooms = Array.isArray(response.data) ? response.data : [];\r\n        console.log('Extracted rooms from response.data:', allRooms);\r\n      } else if (Array.isArray(response)) {\r\n        // Nếu API trả về trực tiếp một mảng\r\n        allRooms = response;\r\n        console.log('Using response directly as rooms array:', allRooms);\r\n      } else {\r\n        console.error('Unexpected API response format:', response);\r\n        setError('Định dạng dữ liệu không hợp lệ');\r\n        setRooms([]);\r\n        return;\r\n      }\r\n\r\n      console.log('All Rooms Before Filter:', allRooms);\r\n\r\n      // Lọc các phòng còn trống và phù hợp với năm học của sinh viên\r\n      const availableRooms = allRooms.filter((room: Room) => {\r\n        // Log chi tiết từng phòng trước khi lọc\r\n        console.log('Checking room:', {\r\n          roomId: room.id,\r\n          roomNumber: room.roomNumber,\r\n          floor: room.floor,\r\n          status: room.status,\r\n          currentOccupancy: room.currentOccupancy,\r\n          capacity: room.capacity,\r\n          studentYear: studentYear\r\n        });\r\n\r\n        const isAvailable = room.status === 'available' || room.status === 'Đã có Người ở';\r\n        const isMatchingYear = Number(room.floor) === Number(studentYear);\r\n        const hasSpace = room.currentOccupancy < room.capacity;\r\n        \r\n        console.log('Room conditions:', {\r\n          roomNumber: room.roomNumber,\r\n          isAvailable,\r\n          isMatchingYear,\r\n          hasSpace,\r\n          willBeIncluded: isAvailable && isMatchingYear && hasSpace\r\n        });\r\n        \r\n        return isAvailable && isMatchingYear && hasSpace;\r\n      });\r\n      \r\n      console.log('Available Rooms After Filter:', availableRooms);\r\n      \r\n      setRooms(availableRooms);\r\n      if (availableRooms.length === 0) {\r\n        setError(`Hiện không có phòng nào khả dụng cho sinh viên năm ${studentYear}`);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error fetching rooms:', error);\r\n      setError(error.message || 'Có lỗi xảy ra khi tải danh sách phòng');\r\n      setRooms([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleRegisterRoom = (roomId: number) => {\r\n    navigate(`/student/room-registration/${roomId}`);\r\n  };\r\n\r\n  const handleAutoRegister = async () => {\r\n    if (!studentId) {\r\n      setError('Không tìm thấy thông tin sinh viên');\r\n      return;\r\n    }\r\n\r\n    setAutoRegistering(true);\r\n    setError('');\r\n    setSuccess('');\r\n\r\n    try {\r\n      // Tìm phòng còn trống đầu tiên phù hợp với năm học của sinh viên\r\n      const availableRoom = rooms.find(room => {\r\n        const isAvailable = room.status === 'available' || \r\n          (room.status === 'Đã có Người ở' && room.currentOccupancy < room.capacity);\r\n        const isMatchingYear = room.floor === studentYear;\r\n        const hasSpace = room.currentOccupancy < room.capacity;\r\n        return isAvailable && isMatchingYear && hasSpace;\r\n      });\r\n\r\n      if (!availableRoom) {\r\n        setError(studentYear !== null ? `Hiện không có phòng nào khả dụng cho sinh viên năm ${studentYear}` : 'Hiện không có phòng nào khả dụng');\r\n        return;\r\n      }\r\n\r\n      // Đăng ký phòng tự động\r\n      await roomAssignmentService.assignRoom({\r\n        roomId: availableRoom.id,\r\n        studentId: studentId,\r\n        startDate: new Date().toISOString().split('T')[0],\r\n        endDate: '',\r\n        isAdmin: true // Đánh dấu là đăng ký tự động, không cần xét duyệt\r\n      });\r\n\r\n      setSuccess(`Đã đăng ký thành công vào phòng ${availableRoom.building} - ${availableRoom.roomNumber}`);\r\n      setAutoRegisterDialogOpen(false);\r\n      navigate('/student/home');\r\n    } catch (err: any) {\r\n      setError(err.response?.data?.message || 'Không thể đăng ký phòng tự động');\r\n    } finally {\r\n      setAutoRegistering(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"60vh\">\r\n        <CircularProgress />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Container maxWidth=\"lg\">\r\n      <Paper sx={{ p: 4, mt: 4 }}>\r\n        <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={3}>\r\n          <Typography variant=\"h4\" gutterBottom>\r\n            Danh sách phòng có sẵn{studentYear !== null ? ` cho sinh viên năm ${studentYear}` : ''}\r\n          </Typography>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={() => setAutoRegisterDialogOpen(true)}\r\n            disabled={hasRoomAssignment || rooms.length === 0}\r\n          >\r\n            Đăng ký tự động\r\n          </Button>\r\n        </Box>\r\n\r\n        {error && (\r\n          <Alert severity=\"error\" sx={{ mb: 2 }}>\r\n            {error}\r\n          </Alert>\r\n        )}\r\n\r\n        {success && (\r\n          <Alert severity=\"success\" sx={{ mb: 2 }}>\r\n            {success}\r\n          </Alert>\r\n        )}\r\n\r\n        {hasRoomAssignment && (\r\n          <Alert severity=\"info\" sx={{ mb: 2 }}>\r\n            Bạn đã có yêu cầu đăng ký phòng đang chờ phê duyệt hoặc đã được gán phòng.\r\n          </Alert>\r\n        )}\r\n\r\n        <Grid container spacing={3}>\r\n          {rooms.map((room) => (\r\n            <Grid item xs={12} sm={6} md={4} key={room.id}>\r\n              <Card>\r\n                <CardContent>\r\n                  <Typography variant=\"h6\" gutterBottom>\r\n                    Phòng {room.roomNumber}\r\n                  </Typography>\r\n                  <Typography color=\"textSecondary\" gutterBottom>\r\n                    Tòa {room.building} - Tầng {room.floor}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\">\r\n                    Loại phòng: {room.type}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\">\r\n                    Giá phòng: {room.price.toLocaleString('vi-VN')} VNĐ/tháng\r\n                  </Typography>\r\n                  <Typography variant=\"body2\">\r\n                    Sức chứa: {room.currentOccupancy}/{room.capacity}\r\n                  </Typography>\r\n                  <Typography variant=\"body2\" color=\"primary\">\r\n                    Trạng thái: {room.status}\r\n                  </Typography>\r\n                </CardContent>\r\n                <CardActions>\r\n                  <Button \r\n                    size=\"small\" \r\n                    color=\"primary\"\r\n                    onClick={() => handleRegisterRoom(room.id)}\r\n                    disabled={hasRoomAssignment}\r\n                  >\r\n                    Đăng ký\r\n                  </Button>\r\n                </CardActions>\r\n              </Card>\r\n            </Grid>\r\n          ))}\r\n        </Grid>\r\n      </Paper>\r\n\r\n      {/* Dialog xác nhận đăng ký tự động */}\r\n      <Dialog\r\n        open={autoRegisterDialogOpen}\r\n        onClose={() => !autoRegistering && setAutoRegisterDialogOpen(false)}\r\n      >\r\n        <DialogTitle>Xác nhận đăng ký tự động</DialogTitle>\r\n        <DialogContent>\r\n          <DialogContentText>\r\n            Hệ thống sẽ tự động đăng ký bạn vào phòng còn trống đầu tiên phù hợp với năm học của bạn. Bạn có chắc chắn muốn tiếp tục?\r\n          </DialogContentText>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button \r\n            onClick={() => setAutoRegisterDialogOpen(false)} \r\n            disabled={autoRegistering}\r\n          >\r\n            Hủy\r\n          </Button>\r\n          <Button \r\n            onClick={handleAutoRegister} \r\n            color=\"primary\" \r\n            disabled={autoRegistering}\r\n            autoFocus\r\n          >\r\n            {autoRegistering ? <CircularProgress size={24} /> : 'Xác nhận'}\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Container>\r\n  );\r\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}